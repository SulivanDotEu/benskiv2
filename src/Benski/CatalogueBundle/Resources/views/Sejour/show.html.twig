{% extends 'BenskiCatalogueBundle:Sejour:layout.html.twig' %}


{% block breadcrumb %}
{{ parent() }}
<li class="active">Show</li>
{% endblock %}


{% block header %}
<h1>Sejour</h1>
{% endblock %}


{% block body -%}

<table class="table table-striped">
   <tbody>
      <tr>
         <th>Id</th>
         <td>{{ entity.id }}</td>
      </tr>
      <tr>
         <th>Nom</th>
         <td>{{ entity.nom }}</td>
      </tr>
      <tr>
         <th>Datedebut</th>
         <td>{{ entity.dateDebut|date('Y-m-d H:i:s') }}</td>
      </tr>
      <tr>
         <th>Datefin</th>
         <td>{{ entity.dateFin|date('Y-m-d H:i:s') }}</td>
      </tr>
   </tbody>
</table>

<div class="pull-right">
   <a class="btn btn-primary" href="{{ path('sejour_appartement_bind', { 'id': entity.id }) }}">
      <i class="icon-plus icon-white"></i>
      Ajouter un appartement
   </a></div>
<h2>Appartement disponibles</h2>

<table class="table table-condensed">
   <thead>
   <th>Destination</th>
   <th>Appartement</th>
   <th>Qualite</th>
   <th>Nombre lits</th>

   <th><span class="text-info">Reservation / </span>Stock</th>
   <th>Nombre personnes</th>
   <th>Prix</th>
   <th>Actions</th>
</thead>
<tbody>
   {% for appart in entity.appartements %}
      {% set rowspan = appart.appartement.nombreLits%}
      <tr>
         <td rowspan="{{rowspan}}">{{ appart.appartement.destination }}</td>
         <td rowspan="{{rowspan}}">{{ appart.appartement.nom }}</td>
         <td rowspan="{{rowspan}}">
         {% for i in range(1, appart.appartement.qualite) %}
               <i class="icon-star"></i>
               {% endfor%}
         </td>
         <td rowspan="{{rowspan}}">{{ appart.appartement.nombreLits}}</td>

         <td rowspan="{{rowspan}}">
            <span class="text-info">133 / </span>{{ appart.stock }}
            <span class="badge badge-success commande-reserve" >101</span>
            <span class="badge badge-info commande-commande" >7</span>
            <span class="badge badge-warning commande-attente" >23</span>
            <span class="badge badge-important commande-annule" >2</span>
         </td>

         <td>1 <i class="icon-user"></i></td>
         <td>{{ appart.prixParPersonne(1)/100|number_format  }} €</td>
         <td rowspan="{{rowspan}}">
            <a class="btn" href="{{ path('sejour_appartement_edit', { 'appartement': appart.appartement.id, 'sejour': appart.sejour.id }) }}">
               Edit</a>
         </td>
      </tr>
      {% for i in range(2, rowspan) %}
      <tr>
         <td>{{i}} <i class="icon-user"></i></td>
         <td>{{ appart.prixParPersonne(i)/100|number_format  }} €</td>
      </tr>
   {% endfor %}
   {% endfor %}

   </tbody>

</table>
{% endblock %}


{% block container_header_right %}
<div class="btn-group">
   <a class="btn " href="{{ path('sejour') }}">
      <i class="icon-chevron-left"></i> 
      Back to the list
   </a>
   <a class="btn " id="test" href="{{ path('sejour_edit', { 'id': entity.id }) }}">
      <i class="icon-pencil"></i> Edit</a>
</a>

</div>
{% endblock %}


{% block javascripts %}
{{ parent() }}
<script  >
$(function(){

   $(".commande-reserve").tooltip({placement:'bottom', title:'reserve'}  );
   $(".commande-annule").tooltip({placement:'bottom', title:'annule'}  );
   $(".commande-attente").tooltip({placement:'bottom', title:'en attente'}  );
   $(".commande-commande").tooltip({placement:'bottom', title:'commade'}  );

});
   </script>
{% endblock javascripts %}